package com.mingh.learn;

import com.google.common.collect.Lists;
import com.mingh.learn.common.exception.BusinessRuntimeException;
import org.apache.commons.collections4.CollectionUtils;
import org.apache.commons.lang3.StringUtils;

import java.io.FileInputStream;
import java.io.OutputStream;
import java.util.Arrays;
import java.util.List;
import java.util.Scanner;
import java.util.stream.Collectors;

public class HelloWorld {

    private static final long DEFAULT_VALUE = (1L << 11) - 1;


    public static void main(String[] args) {

        // 查找在 loki 中不存在的 ID 集合
        findIdsWhichNotInLoki(stringToList(ORDER_IDS_STRING), stringToList(LOKI_IDS_STRING));

    }

    /**
     * 查找在 loki 中不存在的 ID 集合
     * @param orderIds
     * @param lokiIds
     */
    public static void findIdsWhichNotInLoki(List<String> orderIds, List<String> lokiIds) {
        if (CollectionUtils.isEmpty(orderIds) || CollectionUtils.isEmpty(lokiIds)) {
            throw new BusinessRuntimeException("数据集合为空");
        }
        orderIds.forEach(sourceId -> {
            if (!lokiIds.contains(sourceId)) {
                System.out.println(sourceId);
            }
        });
    }

    public static List<String> stringToList(String str) {
        return Arrays.stream(str.split("\n")).distinct().collect(Collectors.toList());
    }

    /**
     * 获取大于或等于num的(2^n)-1的数
     *
     * @param num
     * @return
     */
    private static long powFor(long num) {
        long n = num - 1;
        n |= n >>> 1;
        n |= n >>> 2;
        n |= n >>> 4;
        n |= n >>> 8;
        n |= n >>> 16;
        n |= n >>> 32;
        return Math.max(n, DEFAULT_VALUE);
    }

    /**
     * 将源文件目录下的所有文件信息复制同一个文件内
     * @param sourceFilePath 源文件目录
     * @param targetFilePath 目标文件目录
     */
    private static void collectBusinessProperties(String sourceFilePath, String targetFilePath) {
        if (StringUtils.isBlank(sourceFilePath) || StringUtils.isBlank(targetFilePath)) {
            return;
        }
        // 若源文件下没有文件, 直接返回

        Scanner scan =null;
        OutputStream os = null;
        try {
            scan = new Scanner(new FileInputStream(sourceFilePath));
        } catch (Exception e) {

        } finally {

        }
    }

    private static boolean existsFile(String sourceFilePath) {
        boolean existFile = false;
        try {

        } catch (Exception e) {

        }finally {

        }
        return existFile;
    }

    private static final String LOKI_IDS_STRING = "20210829003682394536\n" +
            "20210829003682394536\n" +
            "20210920003682770711\n" +
            "20210927003682922767\n" +
            "20210928003682947761\n" +
            "20210928003682948214\n" +
            "20210928003682948214\n" +
            "20210928003682950187\n" +
            "20210928003682956299\n" +
            "20210928003682957035\n" +
            "20210928003682961323\n" +
            "20210929003682954791\n" +
            "20210929003682956381\n" +
            "20210929003682961555\n" +
            "20210929003682961935\n" +
            "20210929003682964173\n" +
            "20210929003682964359\n" +
            "20210929003682964451\n" +
            "20210929003682964484\n" +
            "20210929003682965107\n" +
            "20210929003682965113\n" +
            "20210929003682965205\n" +
            "20210929003682965205\n" +
            "20210929003682965216\n" +
            "20210929003682965419\n" +
            "20210929003682965601\n" +
            "20210929003682965603\n" +
            "20210929003682965606\n" +
            "20210929003682965615\n" +
            "20210929003682965686\n" +
            "20210929003682966062\n" +
            "20210929003682966062\n" +
            "20210929003682966274\n" +
            "20210929003682966400\n" +
            "20210929003682966433\n" +
            "20210929003682967439\n" +
            "20210929003682967461\n" +
            "20210929003682968234\n" +
            "20210929003682968234\n" +
            "20210929003682968507\n" +
            "20210929003682969423\n" +
            "20210929003682969548\n" +
            "20210929003682970028\n" +
            "20210929003682972002\n" +
            "20210929003682974165\n" +
            "20210929003682974419\n" +
            "20210929003682975006\n" +
            "20210929003682976135\n" +
            "20210929003682976155\n" +
            "20210929003682976163\n" +
            "20210929003682976185\n" +
            "20210929003682976205\n" +
            "20210929003682976554\n" +
            "20210929003682976578\n" +
            "20210929003682976640\n" +
            "20210929003682976640\n" +
            "20210929003682979017\n" +
            "20210929003682979043\n" +
            "20210929003682979076\n" +
            "20210929003682979080\n" +
            "20210929003682979393\n" +
            "20210929003682979393\n" +
            "20210929003682979672\n" +
            "20210929003682980007\n" +
            "20210929003682983007\n" +
            "20210929003682983039\n" +
            "20210929003682983087\n" +
            "20210929003682983088\n" +
            "20210929003682983101\n" +
            "20210929003682983102\n" +
            "20210929003682983151\n" +
            "20210929003682983190\n" +
            "20210929003682983305\n" +
            "20210929003682983316\n" +
            "20210929003682983324\n" +
            "20210929003682983327\n" +
            "20210929003682983338\n" +
            "20210929003682983352\n" +
            "20210929003682983352\n" +
            "20210929003682983358\n" +
            "20210929003682983396\n" +
            "20210929003682983398\n" +
            "20210929003682983495\n" +
            "20210929003682983528\n" +
            "20210929003682984242\n" +
            "20210929003682984287\n" +
            "20210929003682984352\n" +
            "20210929003682984417\n" +
            "20210929003682984420\n" +
            "20210929003682985034\n" +
            "20210929003682985039\n" +
            "20210929003682985097\n" +
            "20210929003682985106\n" +
            "20210929003682985127\n" +
            "20210929003682985139\n" +
            "20210929003682985191\n" +
            "20210929003682985191\n" +
            "20210929003682985193\n" +
            "20210929003682985195\n" +
            "20210929003682985198\n" +
            "20210929003682985214\n" +
            "20210929003682985274\n" +
            "20210929003682985276\n" +
            "20210929003682985331\n" +
            "20210929003682985335\n" +
            "20210929003682985335\n" +
            "20210929003682985337\n" +
            "20210929003682985345\n" +
            "20210929003682986017\n" +
            "20210929003682986029\n" +
            "20210929003682986034\n" +
            "20210929003682986055\n" +
            "20210929003682986074\n" +
            "20210929003682986088\n" +
            "20210929003682986121\n" +
            "20210929003682986137\n" +
            "20210929003682986139\n" +
            "20210929003682986139\n" +
            "20210929003682986148\n" +
            "20210929003682986154\n" +
            "20210929003682986159\n" +
            "20210929003682986169\n" +
            "20210929003682986192\n" +
            "20210929003682986193\n" +
            "20210929003682986201\n" +
            "20210929003682986212\n" +
            "20210929003682987047\n" +
            "20210929003682987061\n" +
            "20210929003682987066\n" +
            "20210929003682987066\n" +
            "20210929003682987068\n" +
            "20211001003683006136\n" +
            "20211003003683013823\n" +
            "20211003003683013823\n" +
            "20211003003683013823";

    private static final String ORDER_IDS_STRING = "20210920003682770711\n" +
            "20210929003682983212\n" +
            "20210927003682922767\n" +
            "20211001003683006136\n" +
            "20210829003682394536\n" +
            "20210929003682985191\n" +
            "20210929003682986212\n" +
            "20210929003682986192\n" +
            "20210929003682984417\n" +
            "20210928003682956299\n" +
            "20210929003682983101\n" +
            "20210929003682968234\n" +
            "20210929003682983358\n" +
            "20210929003682986159\n" +
            "20210929003682983305\n" +
            "20210928003682961323\n" +
            "20210929003682983396\n" +
            "20210929003682983102\n" +
            "20210929003682984352\n" +
            "20210929003682964484\n" +
            "20210929003682985034\n" +
            "20210929003682965205\n" +
            "20210929003682985198\n" +
            "20210929003682974419\n" +
            "20210929003682985214\n" +
            "20210929003682976163\n" +
            "20210929003682985039\n" +
            "20210929003682965686\n" +
            "20210929003682966393\n" +
            "20210929003682986139\n" +
            "20210929003682986148\n" +
            "20210929003682985097\n" +
            "20210929003682987066\n" +
            "20210929003682985193\n" +
            "20210929003682985195\n" +
            "20210929003682985274\n" +
            "20210928003682957035\n" +
            "20210929003682983352\n" +
            "20210929003682954791\n" +
            "20210929003682983190\n" +
            "20210929003682983088\n" +
            "20210929003682986017\n" +
            "20210929003682986034\n" +
            "20210929003682987061\n" +
            "20210929003682986201\n" +
            "20210929003682986055\n" +
            "20210929003682986169\n" +
            "20210929003682986074\n" +
            "20210929003682985276\n" +
            "20210929003682985106\n" +
            "20210929003682976554\n" +
            "20210929003682964359\n" +
            "20210929003682985127\n" +
            "20210929003682965419\n" +
            "20210929003682967063\n" +
            "20210928003682947808\n" +
            "20210929003682974165\n" +
            "20210929003682975006\n" +
            "20210929003682976205\n" +
            "20210929003682985345\n" +
            "20210929003682983039\n" +
            "20210929003682983316\n" +
            "20210929003682983324\n" +
            "20210929003682983398\n" +
            "20210929003682966400\n" +
            "20210929003682986193\n" +
            "20210929003682983338\n" +
            "20210929003682976135\n" +
            "20210929003682976155\n" +
            "20210929003682965606\n" +
            "20210929003682976185\n" +
            "20210929003682961555\n" +
            "20210929003682983151\n" +
            "20210929003682956381\n" +
            "20210928003682950187\n" +
            "20210929003682983528\n" +
            "20210929003682984420\n" +
            "20210929003682986154\n" +
            "20210929003682967461\n" +
            "20210929003682986137\n" +
            "20210929003682986121\n" +
            "20210929003682986088\n" +
            "20210929003682972002\n" +
            "20210929003682986029\n" +
            "20210929003682979076\n" +
            "20210929003682979080\n" +
            "20210929003682985337\n" +
            "20210929003682979672\n" +
            "20210929003682985331\n" +
            "20210929003682983007\n" +
            "20210929003682985139\n" +
            "20210929003682987047\n" +
            "20210929003682979393\n" +
            "20210929003682987068\n" +
            "20210928003682957229\n" +
            "20210929003682961935\n" +
            "20210928003682957204\n" +
            "20210928003682961264\n" +
            "20210929003682983087\n" +
            "20210929003682966655\n" +
            "20210929003682983327\n" +
            "20210928003682952054\n" +
            "20210928003682951043\n" +
            "20210929003682964451\n" +
            "20210928003682947761\n" +
            "20210928003682948214\n" +
            "20210928003682949315\n" +
            "20210928003682950190\n" +
            "20210928003682954143\n" +
            "20210928003682954171\n" +
            "20210928003682956301\n" +
            "20210928003682957077\n" +
            "20210928003682961098\n" +
            "20210929003682965107\n" +
            "20210929003682965113\n" +
            "20210929003682965601\n" +
            "20210929003682966433\n" +
            "20210929003682967439\n" +
            "20210929003682979017\n" +
            "20210929003682984242\n" +
            "20210929003682984287\n" +
            "20210929003682985335\n" +
            "20210929003682966274\n" +
            "20210929003682966062\n" +
            "20210929003682979043\n" +
            "20210929003682965603\n" +
            "20210929003682965216\n" +
            "20210929003682976640\n" +
            "20210929003682976578\n" +
            "20210928003682956052\n" +
            "20210929003682964173\n" +
            "20210929003682983495\n" +
            "20210928003682954192\n" +
            "20210928003682954278\n" +
            "20210929003682966669\n" +
            "20210929003682969548\n" +
            "20210929003682970028\n" +
            "20210929003682969727\n" +
            "20210929003682980007\n" +
            "20210929003682971068\n" +
            "20210929003682969423\n" +
            "20210929003682968507\n" +
            "20210929003682965615\n" +
            "20210929003682979058\n" +
            "20210929003682974099\n" +
            "20210929003682974588\n" +
            "20210929003682979476\n" +
            "20211003003683013823\n" +
            "20210927003682927426";
}